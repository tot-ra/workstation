{
  "$schema": "https://opencode.ai/config.json",
  "plugin": ["opencode-scheduler"],

  // Модульные инструкции агента (базовые + агент-специфичные)
  "instructions": [
    ".opencode/rules/*.md",
    ".opencode/skills/*.md"
  ],

  "permission": {
    "external_directory": {
      "~/git/**": "allow"
    }
  },

  // Модель по умолчанию (fallback)
  "model": "opencode/kimi-k2.5-free",
  "small_model": "opencode/kimi-k2.5-free",

  // ============ КАСТОМНЫЕ АГЕНТЫ ============
  "agent": {
    // PLANNER: Планирование, анализ, спецификации
    "planner": {
      "model": "google/gemini-2.5-flash",
      "description": "Task planning, requirements analysis, specification creation",
      "instructions": [".opencode/agents/planner.md"],
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "grep": true,
        "glob": true,
        "websearch": true,
        "webfetch": true
      }
    },

    // DEVELOPER: Разработка, кодирование, терминал
    "developer": {
      "model": "anthropic/claude-opus-4-5-20251101",
      "description": "Code implementation, terminal operations, debugging",
      "instructions": [".opencode/agents/developer.md"],
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "grep": true,
        "glob": true,
        "bash": true,
        "codesearch": true,
        "task": true
      }
    },

    // TESTER: Тестирование, ревью, валидация
    "tester": {
      "model": "opencode/kimi-k2.5-free",
      "description": "Code review, test writing, functionality validation",
      "instructions": [".opencode/agents/tester.md"],
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "grep": true,
        "glob": true,
        "bash": true,
        "task": true
      }
    },

    // REVIEWER: Архитектурное ревью, качество кода
    "reviewer": {
      "model": "anthropic/claude-sonnet-4-20250514",
      "description": "Architecture review, code quality analysis, best practices",
      "instructions": [".opencode/agents/reviewer.md"],
      "tools": {
        "read": true,
        "grep": true,
        "glob": true,
        "task": true
      }
    },

    // DOCS: Документация
    "docs": {
      "model": "google/gemini-2.5-flash",
      "description": "Documentation generation, README updates, inline docs",
      "instructions": [".opencode/agents/docs.md"],
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "grep": true,
        "glob": true,
        "webfetch": true
      }
    },

    // RESEARCH: Исследования
    "research": {
      "model": "google/gemini-2.5-flash",
      "description": "Technical research, library investigation, solutions exploration",
      "instructions": [".opencode/agents/research.md"],
      "tools": {
        "websearch": true,
        "webfetch": true,
        "codesearch": true,
        "read": true
      }
    },

    // OPS: DevOps, CI/CD
    "ops": {
      "model": "anthropic/claude-3-5-haiku-20241022",
      "description": "DevOps tasks, CI/CD configuration, deployment scripts",
      "instructions": [".opencode/agents/ops.md"],
      "tools": {
        "read": true,
        "write": true,
        "edit": true,
        "bash": true,
        "grep": true,
        "glob": true
      }
    }
  },

  // ============ MCP СЕРВЕРЫ ============
  "mcp": {
    "context7-library-docs": {
      "type": "local",
      "command": ["npx", "-y", "@upstash/context7-mcp@latest"],
      "enabled": false,
      "timeout": 60000
    },
    "github": {
      "type": "local",
      "command": ["npx", "-y", "@modelcontextprotocol/server-github"],
      "environment": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "{env:GITHUB_PERSONAL_ACCESS_TOKEN}"
      },
      "enabled": true,
      "timeout": 60000
    },
    "search-internet-perplexity": {
      "type": "local",
      "command": ["npx", "-y", "perplexity-mcp"],
      "environment": {
        "PERPLEXITY_API_KEY": "{env:PERPLEXITY_API_KEY}"
      },
      "enabled": true,
      "timeout": 60000
    },
    "chrome-devtools": {
      "type": "local",
      "command": ["npx", "-y", "chrome-devtools-mcp@latest"],
      "enabled": true,
      "timeout": 60000
    },
    "mcp_server_mysql": {
      "type": "local",
      "command": ["npx", "-y", "@benborla29/mcp-server-mysql"],
      "environment": {
        "MYSQL_HOST": "127.0.0.1",
        "MYSQL_PORT": "5100",
        "MYSQL_USER": "root",
        "MYSQL_PASS": "test",
        "ALLOW_INSERT_OPERATION": "false",
        "ALLOW_UPDATE_OPERATION": "false",
        "ALLOW_DELETE_OPERATION": "false"
      },
      "enabled": false,
      "timeout": 60000
    },
    "x-twitter": {
      "type": "local",
      "command": ["npx", "-y", "@mbelinky/x-mcp-server"],
      "environment": {
        "API_KEY": "{env:API_KEY}",
        "API_SECRET_KEY": "{env:API_SECRET_KEY}",
        "ACCESS_TOKEN": "{env:ACCESS_TOKEN}",
        "ACCESS_TOKEN_SECRET": "{env:ACCESS_TOKEN_SECRET}"
      },
      "enabled": true,
      "timeout": 60000
    },
    "google-calendar": {
      "type": "local",
      "command": ["npx", "-y", "@cocal/google-calendar-mcp"],
      "environment": {
        "GOOGLE_OAUTH_CREDENTIALS": "./google_calendar_client_secret.json"
      },
      "enabled": true,
      "timeout": 60000
    }
  }
}
